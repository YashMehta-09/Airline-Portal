package com.airline.dao;


public class FlightRecordsDao implements FlightDao{

	private SessionFactory sessionfactory;
	
	
	public FlightRecordsDao() {
		sessionfactory=HibernateUtil.getSessionFactory();
	}
	
	@Override
	public List<FlightDetails> records(FlightDetails flight) {
		
		Session session=sessionfactory.openSession();
		
		
		String departure=flight.getDeparture();
		String arrival=flight.getArrival();
		Date date=flight.getDate();
		
		System.out.println(departure+"dao");
System.out.println(date+"dao");
		
		System.out.println(arrival+"dao");
		java.sql.Date sqlDate = new java.sql.Date(date.getTime()); 
		String sql = "select * from FlightDetails WHERE departure=\"KOLKATA\"";
		String hql = "from FlightDetails f where f.departure=:dept and f.arrival=:arrival and f.date=:date";
		Query query = session.createQuery(hql);
		//SQLQuery query = session.createSQLQuery(sql);
		session.beginTransaction();
		//query.addEntity(FlightDetails.class);
				query.setParameter("dept",departure);
				query.setParameter("arrival", arrival);
				query.setParameter("date", date);


				//query.setParameter("arrival", arrival);
				List<FlightDetails> flightrecord=query.list();
		
				for(FlightDetails f:flightrecord) {
					System.out.println(f.getArilineName());
					System.out.println(f.getArrival());
					//System.out.println(f.getBusinessPrice());
				}
		if(flightrecord.size()==0) {
		System.out.println("list is empty");	
		}
		else {
			System.out.println("list is full");
		}
		session.getTransaction().commit();
        session.close();
		return flightrecord;
	}

	
}